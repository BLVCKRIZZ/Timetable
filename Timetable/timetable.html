<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Timetable</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/timetable.css">
</head>
<body>

<div id="app-lock" class="auth-gate">
  <div class="auth-card">
    <span class="label">Welcome</span>
    <h1 id="app-auth-title" class="auth-title">Sign in to open your timetable</h1>
    <input id="app-email" type="email" placeholder="Email" spellcheck="false" />
    <input id="app-password" type="password" placeholder="Password" spellcheck="false" />
    <input id="app-confirm-password" type="password" placeholder="Confirm password (for sign up)" spellcheck="false" />
    <button id="signin-btn" class="btn" onclick="appLogin()">Sign In</button>
    <button id="signup-btn" class="btn" onclick="appSignUp()">Create Account</button>
    <span id="app-login-status" class="auth-status">Login required before using this app</span>
  </div>
</div>

<div id="app-shell" class="page app-hidden">
  <div class="header">
    <div class="title-area">
      <span class="label">Timetable</span>
      <input id="main-title" type="text" value="My Weekly Schedule" spellcheck="false" />
      <input class="subtitle-input" type="text" placeholder="Add a subtitle or description..." spellcheck="false" />
    </div>
    <div class="controls">
      <button class="btn" id="settings-toggle-btn" onclick="toggleSettingsPanel()">⚙ Customize</button>
    </div>
  </div>

  <div id="settings-panel" class="settings-panel">
    <div class="settings-grid">
      <div class="settings-card">
        <span class="settings-title">Timetable Tools</span>
        <button class="btn" data-requires-admin onclick="addRow()">+ Add Row</button>
        <button class="btn" data-requires-admin onclick="removeRow()">− Remove Row</button>
        <button class="btn" data-requires-admin onclick="addColumn()">+ Add Column</button>
        <button class="btn" data-requires-admin onclick="removeColumn()">− Remove Column</button>
        <button class="btn danger" data-requires-admin onclick="removeSelectedItem()">Remove Selected</button>
        <button class="btn danger" data-requires-admin onclick="clearAll()">Clear All</button>
      </div>

      <div class="settings-card">
        <span class="settings-title">Manage Data</span>
        <button class="btn small" data-admin-action onclick="clearDefaultPlaceholders()">Clear Defaults</button>
        <button class="btn small" data-admin-action onclick="undoPreviousChange()">Undo Previous</button>
        <button class="btn small danger" data-admin-action onclick="clearAllChanges()">Clear All Changes</button>
      </div>

      <div class="settings-card">
        <span class="settings-title">Cell Colors</span>
        <div class="color-tools">
          <input id="cell-color-picker" class="color-picker" type="color" value="#dbeafe" title="Choose color" />
          <button class="btn small" data-admin-action onclick="applyCustomColorToSelected()">Apply Color</button>
          <button class="btn small" data-admin-action onclick="clearSelectedColor()">Clear Cell Color</button>
        </div>
        <select id="now-line-theme" class="toolbar-select" data-admin-action onchange="setNowLineTheme(this.value)">
          <option value="cyan">Live Line: Cyber Cyan</option>
          <option value="violet">Live Line: Electric Violet</option>
        </select>
      </div>
    </div>
  </div>

  <div class="week-toolbar">
    <div class="toolbar-group">
      <button class="btn small view-toggle active" id="timetable-view-btn" onclick="switchView('timetable')">Timetable</button>
      <button class="btn small view-toggle" id="calendar-view-btn" onclick="switchView('calendar')">Calendar</button>
    </div>
    <div class="toolbar-group">
      <button class="btn small" id="prev-week-btn" onclick="changeWeek(-1)">← Prev Week</button>
      <button class="btn small" onclick="goToCurrentWeek()">Today</button>
      <button class="btn small" id="next-week-btn" onclick="changeWeek(1)">Next Week →</button>
    </div>
    <div class="toolbar-group">
      <select id="country-select" class="toolbar-select" onchange="onCountryChange()"></select>
      <span id="holiday-status" class="auth-status">Loading holidays...</span>
    </div>
    <span id="week-label" class="week-label">Week</span>
  </div>

  <div class="view-stack">
    <div id="timetable-panel" class="view-panel active">
      <div class="table-wrap">
        <div id="now-line" class="now-line"></div>
        <table id="timetable">
          <thead>
            <tr id="header-row">
              <th><input type="text" value="Time" spellcheck="false" /></th>
              <th><input type="text" value="Monday" spellcheck="false" /></th>
              <th><input type="text" value="Tuesday" spellcheck="false" /></th>
              <th><input type="text" value="Wednesday" spellcheck="false" /></th>
              <th><input type="text" value="Thursday" spellcheck="false" /></th>
              <th><input type="text" value="Friday" spellcheck="false" /></th>
              <th><input type="text" value="Saturday" spellcheck="false" /></th>
              <th><input type="text" value="Sunday" spellcheck="false" /></th>
              <th style="min-width:40px;width:40px;"></th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
    </div>

    <div id="calendar-panel" class="view-panel">
      <div class="calendar-wrap">
        <div class="calendar-head">
          <button class="btn small" id="prev-month-btn" onclick="changeMonth(-1)">← Prev Month</button>
          <div id="calendar-title" class="calendar-title">Calendar</div>
          <button class="btn small" id="next-month-btn" onclick="changeMonth(1)">Next Month →</button>
        </div>
        <div id="calendar-grid" class="calendar-grid"></div>
        <div class="calendar-info">
          <span id="country-info">Country: --</span>
          <span id="holiday-count">Public Holidays: 0</span>
        </div>
      </div>
    </div>
  </div>

  <div class="footer">
    <span class="hint">Tip: Keep the page clean by using ⚙ Customize for login, colors and advanced tools</span>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/timetable.js"></script>
</body>
</html>

